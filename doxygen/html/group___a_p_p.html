<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fukuoka Uric Acid Sensor: APP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Fukuoka Uric Acid Sensor
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___a_p_p.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Topics</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">APP</div></div>
</div><!--header-->
<div class="contents">

<p>User modules configuration.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___a_p_p___c_o_n_f_i_g.html">APP_CONFIG</a></td></tr>
<tr class="memdesc:group___a_p_p___c_o_n_f_i_g"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application configuration file. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga929143b674ead78857598ed227613ae2" id="r_ga929143b674ead78857598ed227613ae2"><td class="memItemLeft" align="right" valign="top"><a id="ga929143b674ead78857598ed227613ae2" name="ga929143b674ead78857598ed227613ae2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_GAP</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga929143b674ead78857598ed227613ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab2e96365a0b2a56d208fd8c407ef779c" id="r_gab2e96365a0b2a56d208fd8c407ef779c"><td class="memItemLeft" align="right" valign="top"><a id="gab2e96365a0b2a56d208fd8c407ef779c" name="gab2e96365a0b2a56d208fd8c407ef779c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_TIMER</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:gab2e96365a0b2a56d208fd8c407ef779c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga524e8e4f2e29e3f9477812911c821c79" id="r_ga524e8e4f2e29e3f9477812911c821c79"><td class="memItemLeft" align="right" valign="top"><a id="ga524e8e4f2e29e3f9477812911c821c79" name="ga524e8e4f2e29e3f9477812911c821c79"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_MSG</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga524e8e4f2e29e3f9477812911c821c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08c9db83c31d372382461d98c91af3e5" id="r_ga08c9db83c31d372382461d98c91af3e5"><td class="memItemLeft" align="right" valign="top"><a id="ga08c9db83c31d372382461d98c91af3e5" name="ga08c9db83c31d372382461d98c91af3e5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_SEC</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga08c9db83c31d372382461d98c91af3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88040d3f4e9ec649acbb2274989481ff" id="r_ga88040d3f4e9ec649acbb2274989481ff"><td class="memItemLeft" align="right" valign="top"><a id="ga88040d3f4e9ec649acbb2274989481ff" name="ga88040d3f4e9ec649acbb2274989481ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_DISS</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga88040d3f4e9ec649acbb2274989481ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab62e7ac9577383f92cf28ed2b2781417" id="r_gab62e7ac9577383f92cf28ed2b2781417"><td class="memItemLeft" align="right" valign="top"><a id="gab62e7ac9577383f92cf28ed2b2781417" name="gab62e7ac9577383f92cf28ed2b2781417"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_PROXR</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:gab62e7ac9577383f92cf28ed2b2781417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacbab0ab73ed7cff45b90ec1393cd16c0" id="r_gacbab0ab73ed7cff45b90ec1393cd16c0"><td class="memItemLeft" align="right" valign="top"><a id="gacbab0ab73ed7cff45b90ec1393cd16c0" name="gacbab0ab73ed7cff45b90ec1393cd16c0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_BASS</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:gacbab0ab73ed7cff45b90ec1393cd16c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07c447b8673f83e4c54c827aa23e294a" id="r_ga07c447b8673f83e4c54c827aa23e294a"><td class="memItemLeft" align="right" valign="top"><a id="ga07c447b8673f83e4c54c827aa23e294a" name="ga07c447b8673f83e4c54c827aa23e294a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_FINDL</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga07c447b8673f83e4c54c827aa23e294a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6998932c2b4feec56e237970af1d8d03" id="r_ga6998932c2b4feec56e237970af1d8d03"><td class="memItemLeft" align="right" valign="top"><a id="ga6998932c2b4feec56e237970af1d8d03" name="ga6998932c2b4feec56e237970af1d8d03"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_FINDT</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga6998932c2b4feec56e237970af1d8d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c4e86b67689e4c4ba7210b2307d270b" id="r_ga4c4e86b67689e4c4ba7210b2307d270b"><td class="memItemLeft" align="right" valign="top"><a id="ga4c4e86b67689e4c4ba7210b2307d270b" name="ga4c4e86b67689e4c4ba7210b2307d270b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_SUOTAR</b>&#160;&#160;&#160;(1)</td></tr>
<tr class="separator:ga4c4e86b67689e4c4ba7210b2307d270b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06dc39420b6287ab3d16fe80c5887a31" id="r_ga06dc39420b6287ab3d16fe80c5887a31"><td class="memItemLeft" align="right" valign="top"><a id="ga06dc39420b6287ab3d16fe80c5887a31" name="ga06dc39420b6287ab3d16fe80c5887a31"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_CUSTS1</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga06dc39420b6287ab3d16fe80c5887a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga308d77cc2a059c1b242ff3e9e2f9cea4" id="r_ga308d77cc2a059c1b242ff3e9e2f9cea4"><td class="memItemLeft" align="right" valign="top"><a id="ga308d77cc2a059c1b242ff3e9e2f9cea4" name="ga308d77cc2a059c1b242ff3e9e2f9cea4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXCLUDE_DLG_CUSTS2</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga308d77cc2a059c1b242ff3e9e2f9cea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb679b492d0ccf7e55b77e1126bb312e" id="r_gafb679b492d0ccf7e55b77e1126bb312e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafb679b492d0ccf7e55b77e1126bb312e">CLAMP</a>(value,  min,  max)</td></tr>
<tr class="separator:gafb679b492d0ccf7e55b77e1126bb312e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e728ac9a876d4bc80f78e2e55fd43d6" id="r_ga9e728ac9a876d4bc80f78e2e55fd43d6"><td class="memItemLeft" align="right" valign="top"><a id="ga9e728ac9a876d4bc80f78e2e55fd43d6" name="ga9e728ac9a876d4bc80f78e2e55fd43d6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ADC_ENUM_INPUT</b>&#160;&#160;&#160;ADC_INPUT_SE_P0_6</td></tr>
<tr class="separator:ga9e728ac9a876d4bc80f78e2e55fd43d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac0369c54710505ca740d8e3167b90485" id="r_gac0369c54710505ca740d8e3167b90485"><td class="memItemLeft" align="right" valign="top"><a id="gac0369c54710505ca740d8e3167b90485" name="gac0369c54710505ca740d8e3167b90485"></a>
timer_hnd uvp_timer&#160;</td><td class="memItemRight" valign="bottom"><b>__SECTION_ZERO</b> (&quot;retention_mem_area0&quot;)</td></tr>
<tr class="separator:gac0369c54710505ca740d8e3167b90485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ba40d136da1f704417eac6f4b68c874" id="r_ga0ba40d136da1f704417eac6f4b68c874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0ba40d136da1f704417eac6f4b68c874">uvp_wireless_timer_cb</a> (void)</td></tr>
<tr class="memdesc:ga0ba40d136da1f704417eac6f4b68c874"><td class="mdescLeft">&#160;</td><td class="mdescRight">UVP (for battery voltage) periodic timer callback.  *.  <br /></td></tr>
<tr class="separator:ga0ba40d136da1f704417eac6f4b68c874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9df79242cefcda723510a89b90e0354" id="r_gae9df79242cefcda723510a89b90e0354"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae9df79242cefcda723510a89b90e0354">gpadc_wireless_timer_cb</a> (void)</td></tr>
<tr class="memdesc:gae9df79242cefcda723510a89b90e0354"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sensor Voltage periodic timer callback.  <br /></td></tr>
<tr class="separator:gae9df79242cefcda723510a89b90e0354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c97072d522e510a46ce656a19030f8e" id="r_ga7c97072d522e510a46ce656a19030f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7c97072d522e510a46ce656a19030f8e">gpadc_init_se</a> (adc_input_se_t input, uint8_t smpl_time_mult, adc_input_attn_t input_attenuator, bool chopping, uint8_t oversampling)</td></tr>
<tr class="memdesc:ga7c97072d522e510a46ce656a19030f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the ADC in single-ended mode with given parameters.  <br /></td></tr>
<tr class="separator:ga7c97072d522e510a46ce656a19030f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4fb3777459834fb4d0720eaf119d94f" id="r_gaa4fb3777459834fb4d0720eaf119d94f"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa4fb3777459834fb4d0720eaf119d94f">gpadc_collect_sample</a> (void)</td></tr>
<tr class="memdesc:gaa4fb3777459834fb4d0720eaf119d94f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect a corrected raw ADC sample.  <br /></td></tr>
<tr class="separator:gaa4fb3777459834fb4d0720eaf119d94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8258035a26667ea0be70867e5e483c3f" id="r_ga8258035a26667ea0be70867e5e483c3f"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8258035a26667ea0be70867e5e483c3f">gpadc_sample_to_mv</a> (uint16_t sample)</td></tr>
<tr class="memdesc:ga8258035a26667ea0be70867e5e483c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a corrected ADC sample to a millivolt value.  <br /></td></tr>
<tr class="separator:ga8258035a26667ea0be70867e5e483c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga396eebd5d11d6cc9f0c664317368462a" id="r_ga396eebd5d11d6cc9f0c664317368462a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga396eebd5d11d6cc9f0c664317368462a">timer2_pwm_dc_control_timer_cb</a> (void)</td></tr>
<tr class="memdesc:ga396eebd5d11d6cc9f0c664317368462a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Periodic timer callback that runs the control loop to adjust the PWM Duty Cycle (DC) to compensate for battery voltage (VBAT) changes.  <br /></td></tr>
<tr class="separator:ga396eebd5d11d6cc9f0c664317368462a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5ad8d119c31a70aba28c8f68dffeb64" id="r_gae5ad8d119c31a70aba28c8f68dffeb64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae5ad8d119c31a70aba28c8f68dffeb64">timer2_pwm_dc_control</a> (int16_t target_vbias_mv, tim2_pwm_t channel)</td></tr>
<tr class="memdesc:gae5ad8d119c31a70aba28c8f68dffeb64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates and updates the PWM Duty Cycle (DC) value based on a target output voltage and the current battery voltage (VBAT).  <br /></td></tr>
<tr class="separator:gae5ad8d119c31a70aba28c8f68dffeb64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga761e682d9f65842703360c0c35d85024" id="r_ga761e682d9f65842703360c0c35d85024"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga761e682d9f65842703360c0c35d85024">timer2_pwm_set_offset</a> (uint8_t offset_percentage, tim2_pwm_t channel)</td></tr>
<tr class="memdesc:ga761e682d9f65842703360c0c35d85024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Directly sets the PWM offset (<code>START_CYCLE</code>) as a fixed Duty Cycle (DC) percentage for a channel.  <br /></td></tr>
<tr class="separator:ga761e682d9f65842703360c0c35d85024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12f39c2c81587d0e9a93610ca12310c0" id="r_ga12f39c2c81587d0e9a93610ca12310c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga12f39c2c81587d0e9a93610ca12310c0">timer2_pwm_set_frequency</a> (tim0_2_clk_div_t clk_div, tim2_clk_src_t clk_src, uint16_t pwm_div)</td></tr>
<tr class="memdesc:ga12f39c2c81587d0e9a93610ca12310c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure Timer2 PWM frequency.  <br /></td></tr>
<tr class="separator:ga12f39c2c81587d0e9a93610ca12310c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f6b699b50011cb75aae07787816e2d7" id="r_ga6f6b699b50011cb75aae07787816e2d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6f6b699b50011cb75aae07787816e2d7">timer2_pwm_enable</a> (void)</td></tr>
<tr class="memdesc:ga6f6b699b50011cb75aae07787816e2d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable Timer2 PWM outputs.  <br /></td></tr>
<tr class="separator:ga6f6b699b50011cb75aae07787816e2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c8e71698fc4044fef4e7990642f44e1" id="r_ga8c8e71698fc4044fef4e7990642f44e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8c8e71698fc4044fef4e7990642f44e1">timer2_pwm_disable</a> (void)</td></tr>
<tr class="memdesc:ga8c8e71698fc4044fef4e7990642f44e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable Timer2 PWM outputs.  <br /></td></tr>
<tr class="separator:ga8c8e71698fc4044fef4e7990642f44e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga097fccef82db4a9dfdc1cb542a9e9e20" id="r_ga097fccef82db4a9dfdc1cb542a9e9e20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga097fccef82db4a9dfdc1cb542a9e9e20">user_on_connection</a> (const uint8_t conidx, struct gapc_connection_req_ind const *param)</td></tr>
<tr class="memdesc:ga097fccef82db4a9dfdc1cb542a9e9e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a BLE central connects to the device.  <br /></td></tr>
<tr class="separator:ga097fccef82db4a9dfdc1cb542a9e9e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b05ace9fab6a68b42379e8a17d91d43" id="r_ga2b05ace9fab6a68b42379e8a17d91d43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2b05ace9fab6a68b42379e8a17d91d43">user_on_disconnect</a> (struct gapc_disconnect_ind const *param)</td></tr>
<tr class="memdesc:ga2b05ace9fab6a68b42379e8a17d91d43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a BLE central disconnects.  <br /></td></tr>
<tr class="separator:ga2b05ace9fab6a68b42379e8a17d91d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b3422baf14d93c4ca220ed9999e5a3c" id="r_ga0b3422baf14d93c4ca220ed9999e5a3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0b3422baf14d93c4ca220ed9999e5a3c">user_catch_rest_hndl</a> (ke_msg_id_t const msgid, void const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga0b3422baf14d93c4ca220ed9999e5a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles unprocessed messages (not handled by the SDK) and dispatches custom handlers.  <br /></td></tr>
<tr class="separator:ga0b3422baf14d93c4ca220ed9999e5a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9558355a6c2e75d01e5f38a64460f292" id="r_ga9558355a6c2e75d01e5f38a64460f292"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9558355a6c2e75d01e5f38a64460f292">user_svc1_sensor_voltage_cfg_ind_handler</a> (ke_msg_id_t const msgid, struct custs1_val_write_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga9558355a6c2e75d01e5f38a64460f292"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle CCCD writes to the Sensor Voltage characteristic.  <br /></td></tr>
<tr class="separator:ga9558355a6c2e75d01e5f38a64460f292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14840a8f42cc0574c8b39bd1f3046791" id="r_ga14840a8f42cc0574c8b39bd1f3046791"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga14840a8f42cc0574c8b39bd1f3046791">user_svc1_pwm_freq_wr_ind_handler</a> (ke_msg_id_t const msgid, struct custs1_val_write_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga14840a8f42cc0574c8b39bd1f3046791"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle client writes to PWM Frequency characteristic.  <br /></td></tr>
<tr class="separator:ga14840a8f42cc0574c8b39bd1f3046791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c1a0c412a4500a4e12f0f2ca742624d" id="r_ga7c1a0c412a4500a4e12f0f2ca742624d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7c1a0c412a4500a4e12f0f2ca742624d">user_svc1_pwm_vbias_and_offset_wr_ind_handler</a> (ke_msg_id_t const msgid, struct custs1_val_write_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga7c1a0c412a4500a4e12f0f2ca742624d"><td class="mdescLeft">&#160;</td><td class="mdescRight">BLE Write Indication Handler for the PWM VBIAS and Offset Characteristic.  <br /></td></tr>
<tr class="separator:ga7c1a0c412a4500a4e12f0f2ca742624d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49d7c347aaec71e4d30678215f0c111b" id="r_ga49d7c347aaec71e4d30678215f0c111b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga49d7c347aaec71e4d30678215f0c111b">user_svc1_pwm_state_wr_ind_handler</a> (ke_msg_id_t const msgid, struct custs1_val_write_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga49d7c347aaec71e4d30678215f0c111b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle client write to PWM State characteristic (single-byte ON/OFF).  <br /></td></tr>
<tr class="separator:ga49d7c347aaec71e4d30678215f0c111b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07fe0a9cd441f968b0d9cd7c12c94d84" id="r_ga07fe0a9cd441f968b0d9cd7c12c94d84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga07fe0a9cd441f968b0d9cd7c12c94d84">user_svc1_battery_voltage_cfg_ind_handler</a> (ke_msg_id_t const msgid, struct custs1_val_write_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga07fe0a9cd441f968b0d9cd7c12c94d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle CCCD writes for Battery Voltage characteristic.  <br /></td></tr>
<tr class="separator:ga07fe0a9cd441f968b0d9cd7c12c94d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1687342eb7a2e461d5daf779ec921c37" id="r_ga1687342eb7a2e461d5daf779ec921c37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1687342eb7a2e461d5daf779ec921c37">user_svc1_read_sensor_voltage_handler</a> (ke_msg_id_t const msgid, struct custs1_value_req_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:ga1687342eb7a2e461d5daf779ec921c37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle read request for Sensor Voltage characteristic and respond with last-known value.  <br /></td></tr>
<tr class="separator:ga1687342eb7a2e461d5daf779ec921c37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea308371eb2904fe575d098aa9d717c4" id="r_gaea308371eb2904fe575d098aa9d717c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaea308371eb2904fe575d098aa9d717c4">user_svc1_read_battery_voltage_handler</a> (ke_msg_id_t const msgid, struct custs1_value_req_ind const *param, ke_task_id_t const dest_id, ke_task_id_t const src_id)</td></tr>
<tr class="memdesc:gaea308371eb2904fe575d098aa9d717c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle read request for Battery Voltage characteristic and respond with last-known value.  <br /></td></tr>
<tr class="separator:gaea308371eb2904fe575d098aa9d717c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga868f1e60544dc2092df4c6a7110f461b" id="r_ga868f1e60544dc2092df4c6a7110f461b"><td class="memItemLeft" align="right" valign="top">arch_main_loop_callback_ret_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga868f1e60544dc2092df4c6a7110f461b">user_app_on_system_powered</a> (void)</td></tr>
<tr class="memdesc:ga868f1e60544dc2092df4c6a7110f461b"><td class="mdescLeft">&#160;</td><td class="mdescRight">User callback when the system is powered on.  <br /></td></tr>
<tr class="separator:ga868f1e60544dc2092df4c6a7110f461b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d69ab99f9504092fa8ae723a6ab4cfa" id="r_ga8d69ab99f9504092fa8ae723a6ab4cfa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8d69ab99f9504092fa8ae723a6ab4cfa">user_app_on_init</a> (void)</td></tr>
<tr class="memdesc:ga8d69ab99f9504092fa8ae723a6ab4cfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">User initialization callback executed at boot.  <br /></td></tr>
<tr class="separator:ga8d69ab99f9504092fa8ae723a6ab4cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga386ab66b996c2196b8adb235b24d273f" id="r_ga386ab66b996c2196b8adb235b24d273f"><td class="memItemLeft" align="right" valign="top"><a id="ga386ab66b996c2196b8adb235b24d273f" name="ga386ab66b996c2196b8adb235b24d273f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>uvp_shutdown</b></td></tr>
<tr class="separator:ga386ab66b996c2196b8adb235b24d273f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>User modules configuration. </p>
<dl class="section author"><dt>Author</dt><dd>Albert Nguyen</dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gafb679b492d0ccf7e55b77e1126bb312e" name="gafb679b492d0ccf7e55b77e1126bb312e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb679b492d0ccf7e55b77e1126bb312e">&#9670;&#160;</a></span>CLAMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLAMP</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>min</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">((value) &lt; (min) ? (min) : ((value) &gt; (max) ? (max) : (value)))</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa4fb3777459834fb4d0720eaf119d94f" name="gaa4fb3777459834fb4d0720eaf119d94f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa4fb3777459834fb4d0720eaf119d94f">&#9670;&#160;</a></span>gpadc_collect_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpadc_collect_sample </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Collect a corrected raw ADC sample. </p>
<dl class="section return"><dt>Returns</dt><dd>Corrected raw ADC sample (already processed with adc_correct_sample()).</dd></dl>
<p>This function calls adc_get_sample() and then applies the SDK correction helper adc_correct_sample() to return a usable raw sample. </p><dl class="section see"><dt>See also</dt><dd>adc_get_sample, adc_correct_sample </dd></dl>

</div>
</div>
<a id="ga7c97072d522e510a46ce656a19030f8e" name="ga7c97072d522e510a46ce656a19030f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c97072d522e510a46ce656a19030f8e">&#9670;&#160;</a></span>gpadc_init_se()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpadc_init_se </td>
          <td>(</td>
          <td class="paramtype">adc_input_se_t</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>smpl_time_mult</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">adc_input_attn_t</td>          <td class="paramname"><span class="paramname"><em>input_attenuator</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>chopping</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>oversampling</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the ADC in single-ended mode with given parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>ADC input channel (e.g., P0_6, VBAT_HIGH). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">smpl_time_mult</td><td>Sample time multiplier (1–15). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_attenuator</td><td>Attenuation factor for the ADC input. Must be one of the values from adc_input_attn_t enum. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chopping</td><td>Enable or disable chopping. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oversampling</td><td>Oversampling setting (0–7).</td></tr>
  </table>
  </dd>
</dl>
<p>This helper wraps adc_init() and performs additional recommended setup calls:</p><ul>
<li>disable input shift</li>
<li>disable die temperature sensor</li>
<li>set ADC startup delay (adc_delay_set(64) for 16 MHz system)</li>
<li>enable ADC's LDO load current</li>
<li>reset and calibrate ADC offset</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Input mode is fixed to single-ended in the implementation. ADC should be disabled before re-configuring. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>adc_init, adc_input_shift_disable, adc_temp_sensor_disable, adc_delay_set, adc_offset_calibrate </dd></dl>

</div>
</div>
<a id="ga8258035a26667ea0be70867e5e483c3f" name="ga8258035a26667ea0be70867e5e483c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8258035a26667ea0be70867e5e483c3f">&#9670;&#160;</a></span>gpadc_sample_to_mv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpadc_sample_to_mv </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>sample</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a corrected ADC sample to a millivolt value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sample</td><td>Corrected ADC sample value from <a class="el" href="#gaa4fb3777459834fb4d0720eaf119d94f" title="Collect a corrected raw ADC sample.">gpadc_collect_sample()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Corrected ADC sample value in millivolts (mV).</dd></dl>
<p>The conversion accounts for:</p><ul>
<li>base ADC resolution (10 bits) plus any oversampling contribution,</li>
<li>the ADC internal reference (900 mV) scaled by the input attenuator setting.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The returned uint16_t represents millivolts. When transmitted over BLE the two payload bytes are placed LSB-first (little-endian). </dd></dl>
<dl class="section see"><dt>See also</dt><dd>adc_get_oversampling, GetBits16(GP_ADC_CTRL2_REG, GP_ADC_ATTN) </dd></dl>

</div>
</div>
<a id="gae9df79242cefcda723510a89b90e0354" name="gae9df79242cefcda723510a89b90e0354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9df79242cefcda723510a89b90e0354">&#9670;&#160;</a></span>gpadc_wireless_timer_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpadc_wireless_timer_cb </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sensor Voltage periodic timer callback. </p>
<ul>
<li>Initializes ADC for the sensor input (hardware-dependant).</li>
<li>Performs a single ADC conversion and converts the result to millivolts.</li>
<li>Builds and sends a BLE notification with the 16-bit sensor voltage (mV), sent in little-endian byte order (LSB first).</li>
<li>Disables ADC to reduce power once sample and notification are done.</li>
<li>If the BLE connection remains active, it restarts the timer every 1 s.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Client must wrie to CCCD to enable sensor notifications and for sampling/timers to run. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga7c97072d522e510a46ce656a19030f8e" title="Initialize the ADC in single-ended mode with given parameters.">gpadc_init_se</a>, <a class="el" href="#gaa4fb3777459834fb4d0720eaf119d94f" title="Collect a corrected raw ADC sample.">gpadc_collect_sample</a>, <a class="el" href="#ga8258035a26667ea0be70867e5e483c3f" title="Convert a corrected ADC sample to a millivolt value.">gpadc_sample_to_mv</a>, KE_MSG_ALLOC_DYN, KE_MSG_SEND, ke_state_get </dd></dl>

</div>
</div>
<a id="gae5ad8d119c31a70aba28c8f68dffeb64" name="gae5ad8d119c31a70aba28c8f68dffeb64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5ad8d119c31a70aba28c8f68dffeb64">&#9670;&#160;</a></span>timer2_pwm_dc_control()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_dc_control </td>
          <td>(</td>
          <td class="paramtype">int16_t</td>          <td class="paramname"><span class="paramname"><em>target_vbias_mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tim2_pwm_t</td>          <td class="paramname"><span class="paramname"><em>channel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates and updates the PWM Duty Cycle (DC) value based on a target output voltage and the current battery voltage (VBAT). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target_vbias_mv</td><td>The desired DC target voltage (in mV) for the channel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>The Timer2 PWM channel to be controlled (<code>TIM2_PWM_CHANNEL1</code> to <code>TIM2_PWM_CHANNEL7</code>).</td></tr>
  </table>
  </dd>
</dl>
<p>This function implements the core control logic, calculating the precise Duty Cycle required to maintain the target output voltage despite fluctuations in the battery voltage (VBAT). It is typically called by the periodic timer (<code><a class="el" href="#ga396eebd5d11d6cc9f0c664317368462a" title="Periodic timer callback that runs the control loop to adjust the PWM Duty Cycle (DC) to compensate fo...">timer2_pwm_dc_control_timer_cb()</a></code>).</p>
<ul>
<li><b>Control Logic:</b> This function reads VBAT, applies it to the compensation formula, calculates the necessary PWM pulse width, and writes the resulting <code>END_CYCLE</code> value to the hardware register for the specified channel.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga396eebd5d11d6cc9f0c664317368462a" title="Periodic timer callback that runs the control loop to adjust the PWM Duty Cycle (DC) to compensate fo...">timer2_pwm_dc_control_timer_cb</a>, <a class="el" href="#ga761e682d9f65842703360c0c35d85024" title="Directly sets the PWM offset (START_CYCLE) as a fixed Duty Cycle (DC) percentage for a channel.">timer2_pwm_set_offset</a> </dd></dl>

</div>
</div>
<a id="ga396eebd5d11d6cc9f0c664317368462a" name="ga396eebd5d11d6cc9f0c664317368462a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga396eebd5d11d6cc9f0c664317368462a">&#9670;&#160;</a></span>timer2_pwm_dc_control_timer_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_dc_control_timer_cb </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Periodic timer callback that runs the control loop to adjust the PWM Duty Cycle (DC) to compensate for battery voltage (VBAT) changes. </p>
<p>This function is executed periodically (every 50ms). It sequentially calls the main control function, <code>timer2_pwm_dc_control</code>, for each active PWM channel (<code>TIM2_PWM_2</code> and <code>TIM2_PWM_3</code>) to update their Duty Cycles.</p><ul>
<li><b>Control Sequence:</b></li>
</ul>
<ol type="1">
<li>Restarts the timer (<code>app_easy_timer</code>).</li>
<li>Reads the global battery voltage (VBAT) from the last ADC reading.</li>
<li>Calls <code>timer2_pwm_dc_control</code> to calculate the new PWM pulse width.</li>
<li>Writes the result to the PWM hardware register.</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae5ad8d119c31a70aba28c8f68dffeb64" title="Calculates and updates the PWM Duty Cycle (DC) value based on a target output voltage and the current...">timer2_pwm_dc_control</a>, <a class="el" href="#gaa4fb3777459834fb4d0720eaf119d94f" title="Collect a corrected raw ADC sample.">gpadc_collect_sample</a> </dd></dl>

</div>
</div>
<a id="ga8c8e71698fc4044fef4e7990642f44e1" name="ga8c8e71698fc4044fef4e7990642f44e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c8e71698fc4044fef4e7990642f44e1">&#9670;&#160;</a></span>timer2_pwm_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_disable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable Timer2 PWM outputs. </p>
<p>Stops Timer2 and disables the timer input clock to save power. Per-channel PWM settings are retained in registers and will take effect again when enabled. </p><dl class="section see"><dt>See also</dt><dd>timer2_stop, timer0_2_clk_disable </dd></dl>

</div>
</div>
<a id="ga6f6b699b50011cb75aae07787816e2d7" name="ga6f6b699b50011cb75aae07787816e2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f6b699b50011cb75aae07787816e2d7">&#9670;&#160;</a></span>timer2_pwm_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_enable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable Timer2 PWM outputs. </p>
<p>Enables timer input clock via timer0_2_clk_enable() and starts Timer2 via timer2_start(). Ensure PWM frequency, duty cycles, and offsets are configured prior to enabling. </p><dl class="section see"><dt>See also</dt><dd>timer0_2_clk_enable, timer2_start, <a class="el" href="#ga12f39c2c81587d0e9a93610ca12310c0" title="Configure Timer2 PWM frequency.">timer2_pwm_set_frequency</a>, timer2_pwm_set_dc_and_offset </dd></dl>

</div>
</div>
<a id="ga12f39c2c81587d0e9a93610ca12310c0" name="ga12f39c2c81587d0e9a93610ca12310c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12f39c2c81587d0e9a93610ca12310c0">&#9670;&#160;</a></span>timer2_pwm_set_frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_set_frequency </td>
          <td>(</td>
          <td class="paramtype">tim0_2_clk_div_t</td>          <td class="paramname"><span class="paramname"><em>clk_div</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tim2_clk_src_t</td>          <td class="paramname"><span class="paramname"><em>clk_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>pwm_div</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure Timer2 PWM frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clk_div</td><td>Clock divider enum (tim0_2_clk_div_t). Encoded as shift (1 &lt;&lt; clk_div). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clk_src</td><td>Timer2 clock source enum (tim2_clk_src_t): LP (32 kHz) or SYS (32 MHz). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pwm_div</td><td>PWM divider (2 to 16383). This function clamps out-of-range values.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Computes input_freq = clk_freq / (1 &lt;&lt; clk_div).</li>
<li>Configures timer0_2 clock division and timer2 configuration structs.</li>
<li>Calls timer2_pwm_freq_set(input_freq / pwm_div, input_freq) to program the timer.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>After setting frequency, duty cycle and offsets are configured separately via timer2_pwm_set_dc_and_offset() and the output enabled with <a class="el" href="#ga6f6b699b50011cb75aae07787816e2d7" title="Enable Timer2 PWM outputs.">timer2_pwm_enable()</a>. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>timer0_2_clk_div_set, timer2_config, timer2_pwm_freq_set </dd></dl>

</div>
</div>
<a id="ga761e682d9f65842703360c0c35d85024" name="ga761e682d9f65842703360c0c35d85024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga761e682d9f65842703360c0c35d85024">&#9670;&#160;</a></span>timer2_pwm_set_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer2_pwm_set_offset </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>offset_percentage</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tim2_pwm_t</td>          <td class="paramname"><span class="paramname"><em>channel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Directly sets the PWM offset (<code>START_CYCLE</code>) as a fixed Duty Cycle (DC) percentage for a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">offset_percentage</td><td>The desired PWM Duty Cycle (DC) offset, expressed as a percentage (0-100). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>The Timer2 PWM channel to configure (<code>TIM2_PWM_CHANNEL1</code> to <code>TIM2_PWM_CHANNEL7</code>).</td></tr>
  </table>
  </dd>
</dl>
<p>This function is used to apply a fixed Duty Cycle (DC) offset to the PWM signal by writing the corresponding timer count value directly to the channel's <code>START_CYCLE</code> register. This function is separate from the main VBAT compensation control loop entirely.</p>
<dl class="section note"><dt>Note</dt><dd>The calculated <code>START_CYCLE</code> value depends on the configured Timer2 period.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>timer2_pwm_set_dc_and_offset </dd></dl>

</div>
</div>
<a id="ga8d69ab99f9504092fa8ae723a6ab4cfa" name="ga8d69ab99f9504092fa8ae723a6ab4cfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d69ab99f9504092fa8ae723a6ab4cfa">&#9670;&#160;</a></span>user_app_on_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_app_on_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User initialization callback executed at boot. </p>
<p>Sets retained variables to safe defaults and calls default_app_on_init() as the last action to allow the SDK to finalize initialization. </p><dl class="section see"><dt>See also</dt><dd>default_app_on_init </dd></dl>

</div>
</div>
<a id="ga868f1e60544dc2092df4c6a7110f461b" name="ga868f1e60544dc2092df4c6a7110f461b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga868f1e60544dc2092df4c6a7110f461b">&#9670;&#160;</a></span>user_app_on_system_powered()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">arch_main_loop_callback_ret_t user_app_on_system_powered </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User callback when the system is powered on. </p>
<dl class="section return"><dt>Returns</dt><dd>arch_main_loop_callback_ret_t GOTO_SLEEP to allow SDK to manage sleep mode.</dd></dl>
<ul>
<li>Freezes watchdog, starts UVP timer once, resumes watchdog, and returns GOTO_SLEEP (KEEP_POWERED caused hardfault during debugging). <dl class="section see"><dt>See also</dt><dd>wdg_freeze, wdg_resume, app_easy_timer </dd></dl>
</li>
</ul>

</div>
</div>
<a id="ga0b3422baf14d93c4ca220ed9999e5a3c" name="ga0b3422baf14d93c4ca220ed9999e5a3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b3422baf14d93c4ca220ed9999e5a3c">&#9670;&#160;</a></span>user_catch_rest_hndl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_catch_rest_hndl </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles unprocessed messages (not handled by the SDK) and dispatches custom handlers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID of the incoming message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to the message parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Task ID of the receiver. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Task ID of the sender.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Routes write indications to the appropriate user handlers.</li>
<li>Routes read requests to read handlers or replies with ATT_ERR_APP_ERROR.</li>
<li>Confirms GATTC_EVENT_REQ_IND events to avoid GATT timeouts.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>CUSTS1_VAL_WRITE_IND, CUSTS1_VALUE_REQ_IND, GATTC_EVENT_REQ_IND, KE_MSG_ALLOC, KE_MSG_SEND </dd></dl>

</div>
</div>
<a id="ga097fccef82db4a9dfdc1cb542a9e9e20" name="ga097fccef82db4a9dfdc1cb542a9e9e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga097fccef82db4a9dfdc1cb542a9e9e20">&#9670;&#160;</a></span>user_on_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_on_connection </td>
          <td>(</td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>conidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct gapc_connection_req_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a BLE central connects to the device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">connection_idx</td><td>Connection index assigned by the stack. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to GAPC_CONNECTION_REQ_IND data provided by the stack.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>default_app_on_connection </dd></dl>

</div>
</div>
<a id="ga2b05ace9fab6a68b42379e8a17d91d43" name="ga2b05ace9fab6a68b42379e8a17d91d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2b05ace9fab6a68b42379e8a17d91d43">&#9670;&#160;</a></span>user_on_disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_on_disconnect </td>
          <td>(</td>
          <td class="paramtype">struct gapc_disconnect_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a BLE central disconnects. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to GAPC_DISCONNECT_IND provided by the stack.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>default_app_on_disconnect </dd></dl>

</div>
</div>
<a id="ga07fe0a9cd441f968b0d9cd7c12c94d84" name="ga07fe0a9cd441f968b0d9cd7c12c94d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga07fe0a9cd441f968b0d9cd7c12c94d84">&#9670;&#160;</a></span>user_svc1_battery_voltage_cfg_ind_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_battery_voltage_cfg_ind_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_val_write_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle CCCD writes for Battery Voltage characteristic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VAL_WRITE_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_val_write_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Copies the 2-byte CCCD into a local variable and writes it to retained memory.</li>
<li><a class="el" href="#ga0ba40d136da1f704417eac6f4b68c874" title="UVP (for battery voltage) periodic timer callback.  *.">uvp_wireless_timer_cb()</a> checks uvp_cccd_value and the connection state to decide whether to build and send periodic battery notifications.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The handler itself does not start/stop the UVP timer, it only determines whether notifications will be sent </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0ba40d136da1f704417eac6f4b68c874" title="UVP (for battery voltage) periodic timer callback.  *.">uvp_wireless_timer_cb</a>, KE_MSG_ALLOC_DYN, app_easy_timer </dd></dl>

</div>
</div>
<a id="ga14840a8f42cc0574c8b39bd1f3046791" name="ga14840a8f42cc0574c8b39bd1f3046791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14840a8f42cc0574c8b39bd1f3046791">&#9670;&#160;</a></span>user_svc1_pwm_freq_wr_ind_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_pwm_freq_wr_ind_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_val_write_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle client writes to PWM Frequency characteristic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VAL_WRITE_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_val_write_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Expected byte array payload: [clk_div, clk_src, pwm_div_MSB, pwm_div_LSB].</li>
<li>Validates byte array length and ignores incomplete writes.</li>
<li>Validates clk_div and clk_src within enum ranges and invalid writes.</li>
<li>Calls timer2_pwm_set_frequency(...) which clamps pwm_div to datasheet range. <dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga12f39c2c81587d0e9a93610ca12310c0" title="Configure Timer2 PWM frequency.">timer2_pwm_set_frequency</a>, TIM0_2_CLK_DIV_*, TIM2_CLK_*, CLAMP </dd></dl>
</li>
</ul>

</div>
</div>
<a id="ga49d7c347aaec71e4d30678215f0c111b" name="ga49d7c347aaec71e4d30678215f0c111b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49d7c347aaec71e4d30678215f0c111b">&#9670;&#160;</a></span>user_svc1_pwm_state_wr_ind_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_pwm_state_wr_ind_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_val_write_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle client write to PWM State characteristic (single-byte ON/OFF). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VAL_WRITE_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_val_write_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Reads a single byte state: 0 = OFF, 1 = ON.</li>
<li>If ON: calls <a class="el" href="#ga6f6b699b50011cb75aae07787816e2d7" title="Enable Timer2 PWM outputs.">timer2_pwm_enable()</a> to enable Timer2 clock and start outputs.</li>
<li>If OFF: calls <a class="el" href="#ga8c8e71698fc4044fef4e7990642f44e1" title="Disable Timer2 PWM outputs.">timer2_pwm_disable()</a> to stop outputs and disable timer clock.</li>
<li>Ignores invalid writes (values &gt; 1).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure PWM frequency and duty are configured before enabling output to avoid unexpected signals.</li>
<li><a class="el" href="#ga8c8e71698fc4044fef4e7990642f44e1" title="Disable Timer2 PWM outputs.">timer2_pwm_disable()</a> does not clear configurations; re-enable preserves settings. </li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga6f6b699b50011cb75aae07787816e2d7" title="Enable Timer2 PWM outputs.">timer2_pwm_enable</a>, <a class="el" href="#ga8c8e71698fc4044fef4e7990642f44e1" title="Disable Timer2 PWM outputs.">timer2_pwm_disable</a> </dd></dl>

</div>
</div>
<a id="ga7c1a0c412a4500a4e12f0f2ca742624d" name="ga7c1a0c412a4500a4e12f0f2ca742624d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c1a0c412a4500a4e12f0f2ca742624d">&#9670;&#160;</a></span>user_svc1_pwm_vbias_and_offset_wr_ind_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_pwm_vbias_and_offset_wr_ind_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_val_write_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BLE Write Indication Handler for the PWM VBIAS and Offset Characteristic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VAL_WRITE_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_val_write_ind structure containing the characteristic value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<p>This function is executed when a BLE central device (e.g., a phone) writes to the custom PWM VBIAS and Offset characteristic. It is responsible for parsing the 10-byte payload and immediately applying the requested VBIAS target voltages and PWM offsets for channels <code>TIM2_PWM_2</code> and <code>TIM2_PWM_3</code>.</p>
<p>The handler performs the following critical steps:</p><ol type="1">
<li><b>Guard Check:</b> Prevents changes if the Under Voltage Protection (UVP) shutdown is active.</li>
<li><b>Validation:</b> Checks if the received packet length is exactly 10 bytes.</li>
<li><b>Data Parsing:</b> Extracts two sets of <code>vbias_mv</code> (target voltage in mV), <code>zero_cal</code> (zero-voltage calibration value), and <code>offset</code> (Duty Cycle percentage).</li>
<li><b>Compensation:</b> Subtracts the <code>zero_cal</code> value from the raw <code>vbias_mv</code> targets to compensate for Op Amp rail offsets.</li>
<li><b>Clamping:</b> Clamps the resulting target voltages to the hardware-safe range (±1000 mV).</li>
<li><b>PWM Configuration:</b> Calls <code>timer2_pwm_set_offset</code> for the new <code>START_CYCLE</code> value, and <code>timer2_pwm_dc_control</code> to set the initial PWM Duty Cycle (DC) based on the new targets.</li>
<li><b>Global Update:</b> Updates the global <code>target_vbias_1_mv</code> and <code>target_vbias_2_mv</code> variables, which the periodic compensation loop (<code>timer2_pwm_dc_control_timer_cb</code>) uses for subsequent Duty Cycle updates.</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga761e682d9f65842703360c0c35d85024" title="Directly sets the PWM offset (START_CYCLE) as a fixed Duty Cycle (DC) percentage for a channel.">timer2_pwm_set_offset</a>, <a class="el" href="#gae5ad8d119c31a70aba28c8f68dffeb64" title="Calculates and updates the PWM Duty Cycle (DC) value based on a target output voltage and the current...">timer2_pwm_dc_control</a>, <a class="el" href="#ga396eebd5d11d6cc9f0c664317368462a" title="Periodic timer callback that runs the control loop to adjust the PWM Duty Cycle (DC) to compensate fo...">timer2_pwm_dc_control_timer_cb</a> </dd></dl>

</div>
</div>
<a id="gaea308371eb2904fe575d098aa9d717c4" name="gaea308371eb2904fe575d098aa9d717c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea308371eb2904fe575d098aa9d717c4">&#9670;&#160;</a></span>user_svc1_read_battery_voltage_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_read_battery_voltage_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_value_req_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle read request for Battery Voltage characteristic and respond with last-known value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VALUE_REQ_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_value_req_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Allocates a dynamic message response.</li>
<li>Copies battery voltage into payload (2 bytes, little-endian) and sends message.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>KE_MSG_ALLOC_DYN, KE_MSG_SEND, <a class="el" href="#ga0ba40d136da1f704417eac6f4b68c874" title="UVP (for battery voltage) periodic timer callback.  *.">uvp_wireless_timer_cb</a> </dd></dl>

</div>
</div>
<a id="ga1687342eb7a2e461d5daf779ec921c37" name="ga1687342eb7a2e461d5daf779ec921c37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1687342eb7a2e461d5daf779ec921c37">&#9670;&#160;</a></span>user_svc1_read_sensor_voltage_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_read_sensor_voltage_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_value_req_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle read request for Sensor Voltage characteristic and respond with last-known value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VALUE_REQ_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_value_req_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Allocates a dynamic message response.</li>
<li>Copies sensor voltage into payload (2 bytes, little-endian) and sends message.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Uses retained sensor_adc_sample_mv so reads succeed even if sampling timer is stopped. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>KE_MSG_ALLOC_DYN, KE_MSG_SEND, app_env </dd></dl>

</div>
</div>
<a id="ga9558355a6c2e75d01e5f38a64460f292" name="ga9558355a6c2e75d01e5f38a64460f292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9558355a6c2e75d01e5f38a64460f292">&#9670;&#160;</a></span>user_svc1_sensor_voltage_cfg_ind_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_svc1_sensor_voltage_cfg_ind_handler </td>
          <td>(</td>
          <td class="paramtype">ke_msg_id_t const</td>          <td class="paramname"><span class="paramname"><em>msgid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct custs1_val_write_ind const *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>dest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ke_task_id_t const</td>          <td class="paramname"><span class="paramname"><em>src_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle CCCD writes to the Sensor Voltage characteristic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td>Message ID (CUSTS1_VAL_WRITE_IND). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>Pointer to custs1_val_write_ind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_id</td><td>Receiver task id. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_id</td><td>Sender task id.</td></tr>
  </table>
  </dd>
</dl>
<p>Copies the 2-byte CCCD into a local variable and:</p><ul>
<li>if CCCD = 0x0001 and connected, starts the periodic sensor voltage ADC timer (1 s).</li>
<li>if CCCD = 0x0000, cancels the sensor voltage timer. <dl class="section see"><dt>See also</dt><dd>app_easy_timer, <a class="el" href="#gae9df79242cefcda723510a89b90e0354" title="Sensor Voltage periodic timer callback.">gpadc_wireless_timer_cb</a> </dd></dl>
</li>
</ul>

</div>
</div>
<a id="ga0ba40d136da1f704417eac6f4b68c874" name="ga0ba40d136da1f704417eac6f4b68c874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ba40d136da1f704417eac6f4b68c874">&#9670;&#160;</a></span>uvp_wireless_timer_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uvp_wireless_timer_cb </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UVP (for battery voltage) periodic timer callback.  *. </p>
<p> ****************************************************************************************  *</p>
<p> *  - Samples the VBAT_HIGH ADC channel (single-shot).  *  - Converts raw sample to millivolts.  *  - Compares to a chosen undervoltage shutdown threshold ($\mathbf{1825 \text{ mV}}$) and a restart threshold ($\mathbf{1875 \text{ mV}}$) using hysteresis logic.  *  - If shutdown is triggered, it disables the PWM VBIAS and the sensor sampling timer.  *  - If phone notifications are enabled and the app is connected,  * a BLE notification is built and sent containing the 16-bit  *    battery voltage ($\text{mV}$) in <b>little-endian</b> byte order (LSB first).  *  * </p><dl class="section note"><dt>Note</dt><dd>app_easy_timer ticks are $10 \text{ ms}$ each in SDK6; this callback reschedules  *       itself every $500 \text{ ms}$ or $0.5 \text{ s}$ via app_easy_timer($50$, ...).  * </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga7c97072d522e510a46ce656a19030f8e" title="Initialize the ADC in single-ended mode with given parameters.">gpadc_init_se</a>, <a class="el" href="#gaa4fb3777459834fb4d0720eaf119d94f" title="Collect a corrected raw ADC sample.">gpadc_collect_sample</a>, <a class="el" href="#ga8258035a26667ea0be70867e5e483c3f" title="Convert a corrected ADC sample to a millivolt value.">gpadc_sample_to_mv</a>, KE_MSG_ALLOC_DYN, KE_MSG_SEND  ****************************************************************************************   </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
